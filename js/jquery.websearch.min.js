/*
 * WebSearch - jQuery UI Widget v1.1.2 minified
 *
 * Copyright 2010, Rob Garrison (aka Mottie/Fudgey)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *   jquery.ui.core.js
 *   jquery.ui.widget.js
 *   jquery.ui.button.js
 */

(function(e){var f,c,i,h,g,j,k,m;e.widget("ui.websearch",{options:{defaultSite:"Google",windowTarget:"_blank",windowOptions:"",tooltipClass:"tooltip",hideSelector:false,sortList:true,hidden:false,searchResult:null,websearch:{Google:["ui-icon-google","http://www.google.com/search?q={s}"]}},_create:function(){c=this.options;f=this;this.element.addClass("ui-websearch-input ui-widget-content ui-corner-left").wrap('<div class="ui-websearch ui-widget"/>').after('<button class="ui-websearch ui-state-default '+ c.tooltipClass+'"><span class="ui-icon ui-icon-websearch"></span></button><button class="ui-state-default '+c.tooltipClass+'"><span class="ui-icon ui-icon-websearch-popup ui-icon-triangle-1-s"></span></button><div class="ui-websearch-popup ui-widget ui-widget-content ui-helper-clearfix ui-corner-all"></div>').bind("mouseup focusout",function(){f._popup(false)});i=this.element.closest(".ui-widget");g=i.find(".ui-websearch-popup").hide();h=i.find("button");h.button({text:false, icons:{primary:null}}).removeClass("ui-corner-all ui-button").bind("click",function(){if(e(this).is(".ui-websearch")){f._search();return false}f._popup(true);return false}).filter(":eq(1)").add(g).bind("keyup focusin",function(d){d.type=="focusin"&&f._popup(true);d.which==27&&f._popup(false)});var a,b=[];for(a in c.websearch)if(c.websearch[a][0]!==""){a==c.defaultSite&&f._setSearchSite(a);b.push('<a href="#" class="site ui-state-default" data-name="'+a+'"><span class="ui-icon ui-icon-websearch '+ c.websearch[a][0]+'"></span>'+a+"</a>")}c.sortList&&b.sort();g.html(b.join(" ")||"No Search Engines Set").find(".site").click(function(){f._setSearchSite(e(this).attr("data-name"));f._popup(false);return false}).hover(function(){e(this).toggleClass("ui-state-highlight")}).keyup(function(d){d.which==40&&e(this).next().focus();d.which==38&&e(this).prev().focus()});this.element.keyup(function(d){d.which===13&&f._search()});h.eq(1).addClass("ui-corner-right");c.hideSelector&&h.addClass("ui-corner-right").eq(1).hide(); j=g.width();k=g.outerHeight();m=i.outerHeight();c.hidden&&i.hide()},_popup:function(a){if(!(a&&g.is(":visible")||c.hideSelector))if(a){var b=h.position();a=b.left+j<e(window).width()-50?b.left:e(window).width()-j-50;b=b.top-k<e(window).scrollTop()?b.top+m:b.top-k;g.css({left:a,top:b,width:j}).fadeIn("slow")}else g.fadeOut("slow")},_setSearchSite:function(a){if(typeof a==="undefined"||a===""||!c.websearch.hasOwnProperty(a))return h.attr("title");var b=c.websearch[a];this.element.attr("data-search-string", b[1]||"").next().attr("title",a).find(".ui-icon-websearch").attr("class","ui-icon ui-icon-websearch "+b[0]||"");this.element.trigger("change",a);return a},_search:function(a,b,d){a=escape(a||this.element.val());var l=this.element.attr("data-search-string").replace(/\{s\}/g,a);l===""||a===""||(c.searchResult?c.searchResult.call(this.element,l):window.open(l,b||c.windowTarget,d||c.windowOptions))},current:function(a){return typeof a==="undefined"||a===""?h.attr("title"):this._setSearchSite(a)},search:function(a, b,d){this._search(a,b,d)},destroy:function(){this.element.removeClass("ui-websearch-input ui-widget-content ui-corner-left").removeAttr("data-search-string").parent().find("button, .ui-websearch-popup").remove();this.element.unwrap();e.Widget.prototype.destroy.apply(this,arguments)}})})(jQuery);